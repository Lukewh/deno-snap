name: deno
version: $version
summary: Deno
description: |
  Deno

base: core22
grade: stable
confinement: strict

architectures:
  - build-on: amd64
    build-for: amd64
  - build-on: armhf
    build-for: armhf    

parts:
  deno:
    plugin: dump
    build-packages:
      - unzip
      - curl
    source: https://github.com/denoland/deno_install.git
    override-build: |
      export DENO_INSTALL=$SNAPCRAFT_PART_BUILD
      ./install.sh
      cp $SNAPCRAFT_PROJECT_DIR/wrapper.sh .

    organize:
      $SNAPCRAFT_PART_BUILD/bin/deno: bin/deno
      $SNAPCRAFT_PART_BUILD/wrapper.sh: bin/wrapper.sh

apps:
  deno:
    command: bin/wrapper.sh
    plugs:
      - network
      - network-bind
      - home
